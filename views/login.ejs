<% layout("/layouts/boilerplate") %>
<br />
<br />

<link
  href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"
  rel="stylesheet"
/>
<style>
  /* === Background Styles === */
  body {
    background: url("/background.png") no-repeat center center fixed;
    background-size: cover;
    min-height: 100vh;
    position: relative;
  }

  /* Dark overlay for readability */
  body::before {
    content: "";
    position: absolute;
    inset: 0;
    background: rgba(0, 0, 0, 0.45);
    z-index: 0;
  }

  /* === Container Styles === */
  .login-wrapper {
    position: relative;
    z-index: 1;
    display: flex;
    align-items: center;
    justify-content: center;
    min-height: 90vh;
    padding: 2rem 1rem;
  }

  .form_body {
    background-color: rgba(255, 255, 255, 0.92);
    border-radius: 10px;
    padding: 30px;
    width: 100%;
    max-width: 400px;
    box-shadow: 0 7px 15px rgba(0, 0, 0, 0.4);
    backdrop-filter: blur(5px);
  }

  .login_form input[type="text"],
  .login_form input[type="password"] {
    border-radius: 5px;
    padding: 12px;
    width: 100%;
    margin-top: 10px;
  }

  .password-box {
    position: relative;
  }

  .password-box input {
    padding-right: 45px !important;
  }

  .password-box i {
    position: absolute;
    right: 15px;
    top: 58%;
    transform: translateY(-50%);
    cursor: pointer;
    color: #555;
    font-size: 18px;
    z-index: 2;
  }

  .navigatee {
    color: #797979;
  }

  .navigatee a {
    color: #ff385c;
  }
</style>

<div class="login-wrapper">
  <div class="form_body">
    <form method="POST" action="/login" class="needs-validation" novalidate>
      <h2 class="text-center mb-4">Login</h2>

      <div class="mb-3 login_form">
        <label for="username" class="form-label">Username</label>
        <input
          type="text"
          name="username"
          placeholder="Enter your username"
          class="form-control"
          required
        />
      </div>

      <div class="mb-3 login_form">
        <label for="login-password" class="form-label">Password</label>
        <div class="password-box">
          <input
            type="password"
            name="password"
            id="login-password"
            placeholder="Enter your password"
            class="form-control"
            required
          />
          <i id="login-togglePassword" class="fa-solid fa-eye"></i>
        </div>
        <div class="invalid-feedback">Please enter your password.</div>
      </div>

      <div class="d-grid gap-2 mt-3">
        <button class="btn btn-danger" type="submit">Login</button>
      </div>

      <div class="mt-3 text-center navigatee">
        <a href="/forgot-password">Forgot Password?</a><br />
        Donâ€™t have an account? <a href="/signup">Sign up</a>
      </div>
    </form>
  </div>
</div>

<script>
  // === Bootstrap form validation (no changes needed here) ===
  (function () {
    "use strict";
    const forms = document.querySelectorAll(".needs-validation");
    Array.from(forms).forEach(function (form) {
      form.addEventListener(
        "submit",
        function (event) {
          if (!form.checkValidity()) {
            event.preventDefault();
            event.stopPropagation();
          }
          form.classList.add("was-validated");
        },
        false
      );
    });
  })();

  // === Self-Contained Password Toggler (no changes needed here) ===
  document.addEventListener("DOMContentLoaded", function () {
    const togglePassword = document.getElementById("login-togglePassword");
    const passwordInput = document.getElementById("login-password");

    if (togglePassword && passwordInput) {
      togglePassword.addEventListener("click", function (event) {
        event.stopPropagation();

        const isPassword = passwordInput.type === "password";
        passwordInput.type = isPassword ? "text" : "password";

        this.classList.toggle("fa-eye");
        this.classList.toggle("fa-eye-slash");
      });
    }
  });
</script>
